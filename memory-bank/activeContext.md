# Активный контекст: MCP-сервер для PydanticAI

## Текущий фокус работы

*   Создание базовой структуры MCP-сервера на Go.
*   Реализация механизма чтения/записи конфигурационных файлов для агентов PydanticAI.
*   Интеграция с PydanticAI для запуска и управления агентами.
*   Детализация архитектурных решений.
*   Планирование реализации проекта.

## Последние изменения

*   Созданы основные файлы Memory Bank и документации.
*   Приняты и задокументированы ключевые архитектурные решения.
*   Установлены `pydantic` и `pydantic-settings` в виртуальное окружение проекта.
*   Создан тестовый агент `agents/simple_agent.py` и тестовый конфигурационный файл `configs/agents/test_agent_config.json`.
*   Успешно протестирован запуск агента PydanticAI.

## Следующие шаги

1.  Обновить `progress.md` в Memory Bank.
2.  Детализировать принятые архитектурные решения в `docs/architecture.md` (уже сделано).
3.  **Разработать MCP-сервер на Go:**
    *   **Инициализация проекта Go:** Создать `go.mod` и базовую структуру проекта.
    *   **Реализация MCP-интерфейса:** Определить структуру MCP-сервера и его методов.
    *   **Модуль управления агентами:**
        *   Реализовать функцию `run_agent`: запуск Python-процесса, сохранение PID, перенаправление stdout/stderr.
        *   Реализовать функцию `stop_agent`: завершение Python-процесса по PID.
        *   Реализовать функцию `get_agent_status`: получение статуса процесса.
    *   **Модуль управления конфигурацией:**
        *   Реализовать функцию `update_agent_config`: запись JSON-данных в файл.
        *   Определить путь для хранения конфигурационных файлов (`configs/agents/`).
    *   **Интеграция инструментов MCP:** Зарегистрировать реализованные функции как инструменты MCP-сервера.
    *   **Обработка ошибок:** Внедрить надежную обработку ошибок во всех модулях.
    *   **Логирование:** Настроить логирование для Go-сервера.
4.  **Тестирование:**
    *   Провести модульное тестирование Go-кода.
    *   Провести интеграционное тестирование MCP-сервера с тестовым агентом PydanticAI.

## Активные решения и соображения

*   **Формат конфигурации:** JSON, валидация на стороне Python-агента.
*   **Расположение PydanticAI:** Запускается "внутри" проекта (в `agents/`).
*   **Модульность:** Придерживаться модульного и минималистичного стиля Go-кода.
*   **Взаимодействие Go-Python:** Запуск через `os/exec` с передачей пути к конфигу как аргумента. Перенаправление stdout/stderr агентов в логи Go-сервера.
*   **Управление жизненным циклом:** Отслеживание по PID. Без автоматического перезапуска на первом этапе.
*   **Именование конфигов:** `configs/agents/<agent_id>.json`.
*   **Логирование:** Стандартная библиотека `log` для Go-сервера.
*   **Параллелизм:** Использование `goroutine` для обработки запросов и управления каждым агентом.
*   **Безопасность:** На начальном этапе без сложной аутентификации, предполагается контролируемая среда. Конфиденциальные данные через переменные окружения.
*   **Мониторинг:** Базовый статус "запущен/не запущен" и PID.

## Важные шаблоны и предпочтения

*   Использование стандартных библиотек Go, где это возможно.
*   Четкое разделение ответственности между модулями.
*   Обработка ошибок должна быть явной и информативной.

## Выводы и идеи проекта

*   Важно обеспечить надежную передачу путей к конфигурационным файлам агентам PydanticAI.
*   Рассмотреть возможность использования goroutines для асинхронного запуска и мониторинга агентов.
